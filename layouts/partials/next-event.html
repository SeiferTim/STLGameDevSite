{{- $now := time.Now -}}
{{- $events := slice -}}

{{- range .Site.Data.events -}}
{{- $eventTime := time .dateTime -}}
{{- if ge $eventTime $now -}}
{{- $events = $events | append (dict
"title" .title
"date" $eventTime
"description" .description
"link" .eventUrl
) -}}
{{- end -}}
{{- end -}}

{{- if gt (len $events) 0 -}}
{{- range first 1 (sort $events "date") -}}
<section class="container p-3">
    <h2 class="text-center">{{ .title }}</h2>
    <p class="text-center">
        <strong>{{ time.Format ":date_long" .date }}</strong><br>
        {{ time.Format ":time_short" .date }}
    </p>

    {{/* Auto-link plain URLs in Markdown before rendering */}}
    {{- $linkedDesc := replaceRE `https?://[^\s]+` `<$0>` .description -}}
        <div>{{ $linkedDesc | markdownify }}</div>

        <p class="text-center mt-3">
            <a href="{{ .link }}" class="btn btn-outline-primary" target="_blank">
                <i class="fa-brands fa-meetup"></i> View on Meetup
            </a>
        </p>
</section>
{{- end -}}
{{- else -}}
<section class="container p-3">
    <p class="text-center">No upcoming events</p>
</section>
{{- end -}}